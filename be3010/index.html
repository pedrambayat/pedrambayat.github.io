<!DOCTYPE html> <html lang="en"> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title> Simplified Phase Vocoder | Pedram Bayat </title> <meta name="author" content="Pedram Bayat"> <meta name="description" content="Implementation of a simplified phase vocoder system in MATLAB to tune vocal input to the C Major scale. BE 3010 (Signals &amp; Systems)."> <meta name="keywords" content="jekyll, jekyll-theme, academic-website, portfolio-website, pedram-bayat"> <link rel="stylesheet" href="/assets/css/bootstrap.min.css?a4b3f509e79c54a512b890d73235ef04"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link defer rel="stylesheet" href="/assets/css/academicons.min.css?f0b7046b84e425c55f3463ac249818f5"> <link defer rel="stylesheet" href="/assets/css/scholar-icons.css?62b2ac103a88034e6882a5be5f3e2772"> <link defer rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons&amp;display=swap"> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-github.css?591dab5a4e56573bf4ef7fd332894c99" media="" id="highlight_theme_light"> <link rel="shortcut icon" href="data:image/svg+xml,&lt;svg%20xmlns=%22http://www.w3.org/2000/svg%22%20viewBox=%220%200%20100%20100%22&gt;&lt;text%20y=%22.9em%22%20font-size=%2290%22&gt;%F0%9F%A7%A0&lt;/text&gt;&lt;/svg&gt;"> <link rel="stylesheet" href="/assets/css/main.css?d41d8cd98f00b204e9800998ecf8427e"> <link rel="canonical" href="https://pedrambayat.github.io/be3010/"> <script src="/assets/js/theme.js?a81d82887dd692e91686b43de4542f18"></script> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-native.css?5847e5ed4a4568527aa6cfab446049ca" media="none" id="highlight_theme_dark"> <script>
    initTheme();
  </script> </head> <body class="fixed-top-nav "> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top" role="navigation"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/"> <span class="font-weight-bold">Pedram</span> Bayat </a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">About </a> </li> <li class="nav-item "> <a class="nav-link" href="/publications/">Publications </a> </li> <li class="nav-item "> <a class="nav-link" href="/projects/">Projects </a> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="ti ti-sun-moon" id="light-toggle-system"></i> <i class="ti ti-moon-filled" id="light-toggle-dark"></i> <i class="ti ti-sun-filled" id="light-toggle-light"></i> </button> </li> </ul> </div> </div> </nav> <progress id="progress" value="0"> <div class="progress-container"> <span class="progress-bar"></span> </div> </progress> </header> <div class="container mt-5" role="main"> <div class="post"> <header class="post-header"> <h1 class="post-title">Simplified Phase Vocoder</h1> <p class="post-description">Implementation of a simplified phase vocoder system in MATLAB to tune vocal input to the C Major scale. BE 3010 (Signals &amp; Systems).</p> </header> <article> <h3 id="project-overview--motivation">Project Overview &amp; Motivation</h3> <p>Pitch correction systems (e.g. Antares Auto-Tune) are widely utilized in modern audio processing to refine intonation in vocal recordings. At their core, these systems estimate the fundamental frequency of input vocals and map them to the nearest note in a target musical scale, stabilizing a singer’s pitch for greater accuracy and stylistic effect.</p> <p>From a signals and systems perspective, vocal recordings are non-stationary signals, meaning their frequency evolves continuously over time. Consequently, a traditional Fourier Transform (FT), which provides a global frequency representation, is insufficient for analysis. Each time-localized segment must be analyzed individually, which can be accomplished by the Short-Time Fourier Transform (STFT).</p> <p>The aim of this project was to implement a simplified phase vocoder system in MATLAB, designed to tune a vocal input to the C Major scale. The system corrects pitches of a C Major scale sung a cappella with intentional errors, such as singing some notes flat (slightly lower frequency) and some notes sharp (slightly higher frequency).</p> <p>Check out the project report <a href="/assets/pdf/be3010paper.pdf">here</a>.</p> <h3 id="methods">Methods</h3> <p>The pitch correction system was implemented using an STFT framework and spectral analysis akin to the analysis done by a Phase Vocoder.</p> <p><strong>Signal Analysis:</strong></p> <p>The input audio signal was first converted to mono and segmented into overlapping frames. An STFT window size of N=2048 was selected as a practical trade-off between frequency resolution and time resolution. At a sampling rate of fs=44.1 kHz, a 2048-sample window spans approximately 46 ms, long enough to assume the signal is locally stationary. The corresponding frequency resolution is 21.5 Hz, which is sufficient to resolve harmonic structure in vocal signals. A Hanning window was applied to each frame before applying the Fast Fourier Transform (FFT) to reduce spectral leakage. A hop size of N/4 (512 samples) resulting in 75% overlap was chosen to ensure smooth reconstruction.</p> <p><strong>Pitch Detection &amp; Modification Pipeline:</strong></p> <p>The pitch correction logic was carried out through three steps:</p> <ol> <li> <strong>Peak Detection</strong>: The algorithm identifies the index corresponding to the maximum magnitude in the spectrum and calculates the current pitch.</li> <li> <strong>Quantization</strong>: The system compares the current frequency against a predefined array of target frequencies corresponding to the C Major scale starting at C4 (261.63 Hz, 293.66 Hz, …). The nearest target frequency is selected, and a shift factor is derived.</li> <li> <strong>Spectral Remapping</strong>: The magnitude spectrum is frequency-warped by mapping the energy from original bins to new bins based on the shift factor. Crucially, the original phase information was preserved and recombined with the shifted magnitude—a simplified phase-vocoder approach that avoids complex phase unwrapping but introduces phase incoherence artifacts.</li> </ol> <p><strong>Noise Reduction Strategy:</strong></p> <p>A two-stage filtering strategy was implemented to reduce artifacts and background noise:</p> <ol> <li> <strong>Harmonic Masking</strong>: A “comb filter” mask was generated in the spectral domain. Based on the target frequency, the mask preserves frequencies at harmonics of the fundamental frequency (up to 8 harmonics) and attenuates other frequencies with a bandwidth of ±60 Hz.</li> <li> <strong>Global Band-Pass Filter</strong>: A 4th-order Butterworth band-pass filter with cutoffs at 100 Hz and 3500 Hz was applied to preserve the fundamental frequency and its harmonics while attenuating background noise.</li> </ol> <p><strong>Signal Reconstruction:</strong></p> <p>The modified frequency spectrum was converted back to the time domain using the Inverse FFT. A second Hanning window was applied to the output frame before reconstructing the continuous signal via the overlap-add method.</p> <h3 id="results">Results</h3> <p>The pitch correction system was evaluated with spectral analysis and by inspection of the processed vocal recording. The spectrograms of the input signal and the pitch-corrected output demonstrated successful tuning of the input to the target C Major scale, with signal attenuation between harmonic partials.</p> <div class="row"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/be3010-results-480.webp 480w,/assets/img/be3010-results-800.webp 800w,/assets/img/be3010-results-1400.webp 1400w," type="image/webp" sizes="95vw"></source> <img src="/assets/img/be3010-results.png" class="img-fluid rounded z-depth-1 mx-auto d-block" width="80%" height="auto" title="Filtered Phase Output" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <div class="caption"> The hybrid noise reduction system indicates the effective suppression of background noise (deep blue regions between harmonic partials) and a global band-pass filter. </div> <p>The hybrid noise reduction process effectively reduced background noise but left vertical striations across the spectrum, likely corresponding to phase discontinuities at STFT frame boundaries. The processed audio signal had noticeably lower quality and clarity than the original signal, with “robotic” artifacts corresponding to phase discontinuities introduced by the simplified approach of preserving original phase information rather than explicitly propagating phase through frames.</p> <h3 id="key-insights--future-work">Key Insights &amp; Future Work</h3> <p>This work successfully demonstrates that frequency-domain pitch correction using an STFT-based framework is effective for refining discrete pitch errors. However, the simplified implementation reveals the need for phase-aware approaches to achieve more natural vocal processing.</p> <p>To enhance the naturalness of the output in future iterations, a standard phase vocoder algorithm could be implemented to explicitly calculate and propagate phase through each frequency frame, which would enforce continuous phase through frame boundaries and likely reduce the “robotic” striations visible in the output spectrogram. Additionally, more precise adjustments could be made by estimating the entire spectral envelope (e.g. Linear Predictive Coding) and only adjusting the original frequencies by shifting the fine harmonic structure. Finally, data-driven machine learning models could be incorporated to learn pitch trajectories and correction strengths from real vocal performance, enabling more adaptive and natural pitch correction.</p> <h3 id="skills-used">Skills Used</h3> <ul> <li> <strong>Programming</strong>: MATLAB, Signal Processing Toolbox</li> <li> <strong>Signal Processing Concepts</strong>: STFT, Phase Vocoder, FFT/IFFT, Windowing, Overlap-Add Method</li> <li> <strong>Audio Processing</strong>: Pitch Detection, Spectral Analysis, Harmonic Filtering, Band-Pass Filtering</li> </ul> </article> </div> </div> <footer class="fixed-bottom" role="contentinfo"> <div class="container mt-0"> © Copyright 2026 Pedram Bayat. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="/assets/js/bootstrap.bundle.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@5.0.0/imagesloaded.pkgd.min.js" integrity="sha256-htrLFfZJ6v5udOG+3kNLINIKh2gvoKqwEhHYfTTMICc=" crossorigin="anonymous"></script> <script defer src="/assets/js/masonry.js?a0db7e5d5c70cc3252b3138b0c91dcaf" type="text/javascript"></script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.1.0/dist/medium-zoom.min.js" integrity="sha256-ZgMyDAIYDYGxbcpJcfUnYwNevG/xi9OHKaR/8GK+jWc=" crossorigin="anonymous"></script> <script defer src="/assets/js/zoom.js?85ddb88934d28b74e78031fd54cf8308"></script> <script src="/assets/js/no_defer.js?2781658a0a2b13ed609542042a859126"></script> <script defer src="/assets/js/common.js?e0514a05c5c95ac1a93a8dfd5249b92e"></script> <script defer src="/assets/js/copy_code.js?c8a01c11a92744d44b093fc3bda915df" type="text/javascript"></script> <script defer src="/assets/js/jupyter_new_tab.js?d9f17b6adc2311cbabd747f4538bb15f"></script> <script async src="https://d1bxh8uas1mnw7.cloudfront.net/assets/embed.js"></script> <script async src="https://badge.dimensions.ai/badge.js"></script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.js" integrity="sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI=" crossorigin="anonymous"></script> <script src="/assets/js/mathjax-setup.js?a5bb4e6a542c546dd929b24b8b236dfd"></script> <script defer src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6" crossorigin="anonymous"></script> <script defer src="/assets/js/progress-bar.js?2f30e0e6801ea8f5036fa66e1ab0a71a" type="text/javascript"></script> <script src="/assets/js/vanilla-back-to-top.min.js?f40d453793ff4f64e238e420181a1d17"></script> <script>
    addBackToTop();
  </script> </body> </html>