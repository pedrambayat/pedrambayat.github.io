<!DOCTYPE html> <html lang="en"> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title> Multi-modal Sequence Encoding for AMPs | Pedram Bayat </title> <meta name="author" content="Pedram Bayat"> <meta name="description" content="Benchmarking peptide sequence encoders and multi-modal transfer learning for out-of-distribution generalization. CIS 5200 (Machine Learning)."> <meta name="keywords" content="jekyll, jekyll-theme, academic-website, portfolio-website, pedram-bayat"> <link rel="stylesheet" href="/assets/css/bootstrap.min.css?a4b3f509e79c54a512b890d73235ef04"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link defer rel="stylesheet" href="/assets/css/academicons.min.css?f0b7046b84e425c55f3463ac249818f5"> <link defer rel="stylesheet" href="/assets/css/scholar-icons.css?62b2ac103a88034e6882a5be5f3e2772"> <link defer rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons&amp;display=swap"> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-github.css?591dab5a4e56573bf4ef7fd332894c99" media="" id="highlight_theme_light"> <link rel="shortcut icon" href="data:image/svg+xml,&lt;svg%20xmlns=%22http://www.w3.org/2000/svg%22%20viewBox=%220%200%20100%20100%22&gt;&lt;text%20y=%22.9em%22%20font-size=%2290%22&gt;%F0%9F%A7%A0&lt;/text&gt;&lt;/svg&gt;"> <link rel="stylesheet" href="/assets/css/main.css?d41d8cd98f00b204e9800998ecf8427e"> <link rel="canonical" href="https://pedrambayat.github.io/amp/"> <script src="/assets/js/theme.js?a81d82887dd692e91686b43de4542f18"></script> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-native.css?5847e5ed4a4568527aa6cfab446049ca" media="none" id="highlight_theme_dark"> <script>
    initTheme();
  </script> </head> <body class="fixed-top-nav "> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top" role="navigation"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/"> <span class="font-weight-bold">Pedram</span> Bayat </a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">About </a> </li> <li class="nav-item "> <a class="nav-link" href="/publications/">Publications </a> </li> <li class="nav-item "> <a class="nav-link" href="/projects/">Projects </a> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="ti ti-sun-moon" id="light-toggle-system"></i> <i class="ti ti-moon-filled" id="light-toggle-dark"></i> <i class="ti ti-sun-filled" id="light-toggle-light"></i> </button> </li> </ul> </div> </div> </nav> <progress id="progress" value="0"> <div class="progress-container"> <span class="progress-bar"></span> </div> </progress> </header> <div class="container mt-5" role="main"> <div class="post"> <header class="post-header"> <h1 class="post-title">Multi-modal Sequence Encoding for AMPs</h1> <p class="post-description">Benchmarking peptide sequence encoders and multi-modal transfer learning for out-of-distribution generalization. CIS 5200 (Machine Learning).</p> </header> <article> <h3 id="project-overview--motivation">Project Overview &amp; Motivation</h3> <p>Addressing the critical global health crisis posed by antimicrobial resistance (AMR), this project utilized a deep learning approach to mine peptide proteomes, focusing on the novel application of <strong>molecular de-extinction</strong> to identify potential antimicrobial peptides (AMPs) from ancient organisms.</p> <p>The central challenge was addressing <strong>distribution shift</strong> in peptide activity prediction. While modern sequence-based models perform well on familiar data, they often fail when applied to novel, out-of-distribution (OOD) sequences. We investigated whether augmenting a high-capacity sequence encoder with structural features from AlphaFold could mitigate performance collapse when moving from modern to ancient peptide domains.</p> <p><strong>Project Aims:</strong></p> <ol> <li>Train a deep learning model that learns high-dimensional latent representations of antimicrobial peptides directly from raw sequence data and rigorously compare its accuracy with traditional baseline models.</li> <li>Test the generalization of this model on an out-of-distribution dataset of extinct peptides.</li> </ol> <p>Check out the project notebook <a href="https://github.com/pedrambayat/MIC_prediction" rel="external nofollow noopener" target="_blank">here</a>, and the paper <a href="/assets/pdf/cis5200paper.pdf">here</a>.</p> <h3 id="methods--model-architecture">Methods &amp; Model Architecture</h3> <p>We formulated the prediction of log2-transformed Minimum Inhibitory Concentration (MIC) as a supervised regression task, using the publicly available Database of Antimicrobial Activity and Structure of Peptides (DBAASP) with 25,306 unique peptide-target interactions across 6,233 sequences and 50 bacterial targets.</p> <p>Our technical workflow focused on three main ML paradigms:</p> <ol> <li> <strong>Encoder Development</strong>: We implemented an APEX-based Sequence Encoder combining GRU layers with attention mechanisms to translate primary amino acid sequences into high-dimensional latent representations.</li> <li> <strong>Multi-modal Transfer Learning</strong>: To improve OOD stability, we integrated five explicit structural features (pLDDT, helix fraction, disordered state, etc.) extracted from AlphaFold via ColabFold. These were concatenated into a multi-modal layer to provide the model with geometric context.</li> <li> <strong>Baseline Comparison &amp; Interpretability</strong>: We benchmarked against tree-based models (XGBoost, Random Forest) and utilized feature importance analysis to quantify the specific contribution of structural versus sequence-based features to the model’s final decision-making process.</li> </ol> <div class="row"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/cis5200-480.webp 480w,/assets/img/cis5200-800.webp 800w,/assets/img/cis5200-1400.webp 1400w," type="image/webp" sizes="95vw"></source> <img src="/assets/img/cis5200.png" class="img-fluid rounded z-depth-1 mx-auto d-block" width="80%" height="auto" title="Model Architecture" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <div class="caption"> Diagram of the multi-modal pipeline, showing the integration of sequence embeddings and AlphaFold structural features. </div> <h3 id="results--key-insights">Results &amp; Key Insights</h3> <p>Our evaluation focused on the delta between in-distribution and out-of-distribution performance:</p> <ul> <li> <strong>In-Distribution Performance</strong>: The APEX-based Sequence Encoder achieved robust performance with <strong>Spearman rho = 0.79</strong> and <strong>R² = 0.62</strong>, confirming strong predictive capability for the training domain. Baseline models (XGBoost, Random Forest) reached comparable performance, demonstrating the model’s stable in-distribution interpolation capability.</li> <li> <strong>Generalization Gap</strong>: Testing on an out-of-distribution dataset of 69 extinct peptides (41 validated AMPs) resulted in a significant <strong>performance collapse</strong>, where the Spearman rho dropped to <strong>0.36</strong>, confirming the challenge of evolutionary generalization.</li> <li> <strong>Feature Rejection &amp; Scientific Insight</strong>: Our multi-modal integration revealed that the model assigned <strong>&lt; 1% feature weight</strong> to structural data, providing a crucial scientific insight: the low-value of static structural predictions (e.g., disordered state) for dynamic, membrane-targeting AMPs. The model’s rejection of structural features suggests that static 3D structures lack high predictive correlation with antimicrobial activity in this shifted domain.</li> </ul> <div class="row justify-content-sm-center"> <div class="col-sm-8 mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/cis5200-results-480.webp 480w,/assets/img/cis5200-results-800.webp 800w,/assets/img/cis5200-results-1400.webp 1400w," type="image/webp" sizes="95vw"></source> <img src="/assets/img/cis5200-results.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" title="Spearman Correlation" loading="lazy" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <div class="caption"> Correlation analysis of predicted vs. actual activity, highlighting the generalization challenges in OOD datasets. </div> <p>This work successfully validates a high-performance sequence baseline but establishes that the primary bottleneck in next-generation AMP discovery lies in the current inability to model dynamic, bioactive structural states. Future work could explore Graph Neural Networks (GNNs) to fully utilize rich structural information from AlphaFold without losing information through summary statistics.</p> <h3 id="skills-used">Skills Used</h3> <ul> <li> <strong>Programming:</strong> PyTorch, scikit-learn, Pandas, NumPy, modlAMP, ColabFold</li> <li> <strong>ML concepts:</strong> GRU networks, attention mechanisms, transfer learning, multi-modal learning, XGBoost, Random Forest, regression, out-of-distribution generalization, feature importance analysis</li> <li> <strong>Domain-specific:</strong> AlphaFold, protein structure prediction, antimicrobial peptides, DBAASP database, sequence encoding</li> </ul> </article> </div> </div> <footer class="fixed-bottom" role="contentinfo"> <div class="container mt-0"> © Copyright 2026 Pedram Bayat. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="/assets/js/bootstrap.bundle.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@5.0.0/imagesloaded.pkgd.min.js" integrity="sha256-htrLFfZJ6v5udOG+3kNLINIKh2gvoKqwEhHYfTTMICc=" crossorigin="anonymous"></script> <script defer src="/assets/js/masonry.js?a0db7e5d5c70cc3252b3138b0c91dcaf" type="text/javascript"></script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.1.0/dist/medium-zoom.min.js" integrity="sha256-ZgMyDAIYDYGxbcpJcfUnYwNevG/xi9OHKaR/8GK+jWc=" crossorigin="anonymous"></script> <script defer src="/assets/js/zoom.js?85ddb88934d28b74e78031fd54cf8308"></script> <script src="/assets/js/no_defer.js?2781658a0a2b13ed609542042a859126"></script> <script defer src="/assets/js/common.js?e0514a05c5c95ac1a93a8dfd5249b92e"></script> <script defer src="/assets/js/copy_code.js?c8a01c11a92744d44b093fc3bda915df" type="text/javascript"></script> <script defer src="/assets/js/jupyter_new_tab.js?d9f17b6adc2311cbabd747f4538bb15f"></script> <script async src="https://d1bxh8uas1mnw7.cloudfront.net/assets/embed.js"></script> <script async src="https://badge.dimensions.ai/badge.js"></script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.js" integrity="sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI=" crossorigin="anonymous"></script> <script src="/assets/js/mathjax-setup.js?a5bb4e6a542c546dd929b24b8b236dfd"></script> <script defer src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6" crossorigin="anonymous"></script> <script defer src="/assets/js/progress-bar.js?2f30e0e6801ea8f5036fa66e1ab0a71a" type="text/javascript"></script> <script src="/assets/js/vanilla-back-to-top.min.js?f40d453793ff4f64e238e420181a1d17"></script> <script>
    addBackToTop();
  </script> </body> </html>